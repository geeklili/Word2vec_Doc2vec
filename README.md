Word2Vec和Doc2Vec的实际应用
=============
利用Word2Vec与SVM进行情感分析
-------------
在理解Word2vec之前，先聊聊NLP(自然语言处理)。NLP里面，最细粒度的是词语，词语组成句子，句子再组成段落、篇章、文档。所以处理NLP的问题，首先就要拿词语开刀。

举个简单例子，判断一个词的词性，是动词还是名词。用机器学习的思路，我们有一系列样本(x,y)，这里x是词语，y是它们的词性，我们要构建f(x)->y的映射，但这里的数学模型f（比如神经网络、SVM）只接受数值型输入，而NLP里的词语，是人类的抽象总结，是符号形式的（比如中文、英文、拉丁文等等），所以需要把他们转换成数值形式，或者说——嵌入到一个数学空间里，这种嵌入方式，就叫词嵌入（word embedding)，而Word2vec，就是词嵌入（wordembedding)的一种

其实，大部分的机器学习模型，都可以归结为：

`f(x)->y`

在NLP中，把x看做一个句子里的一个词语，y是这个词语的上下文词语，那么这里的f，便是NLP中经常出现的『主题模型』，这个模型的目的，就是判断(x,y)这个样本，是否符合自然语言的法则，更通俗点说就是：词语x和词语y放在一起，是不是人话。

Word2vec正是来源于这个思想，但它的最终目的，不是要把f训练得多么完美，而是只关心模型训练完后的副产物——模型参数（这里特指神经网络的权重），并将这些参数，作为输入x的某种向量化的表示，这个向量便叫做——词向量。

我们来看个例子，如何用Word2vec寻找相似词：

* 对于一句话：『她们夸吴彦祖帅到没朋友』，如果输入x是『吴彦祖』，那么y可以是『她们』、『夸』、『帅』、『没朋友』这些词

* 现有另一句话：『她们夸我帅到没朋友』，如果输入x是『我』，那么不难发现，这里的上下文y跟上面一句话一样

* 从而f(吴彦祖)=f(我)=y，所以大数据告诉我们：我=吴彦祖（完美的结论）

...
=============
利用Doc2Vec计算文档相似度
-------------
Doc2Vec模型基于Word2vec模型，并在其基础上增加了一个段落向量。
以Doc2Vec的C-BOW方法为例
1)	训练过程中新增了paragraph id，即训练语料中每个句子都有一个唯一的id。paragraph id和普通的word一样，也是先映射成一个向量，即paragraph vector。paragraph vector与word vector的维数虽一样，但是来自于两个不同的向量空间。在之后的计算里，paragraph vector和word vector累加或者连接起来，作为输出层softmax的输入。在一个句子或者文档的训练过程中，paragraph id保持不变，共享着同一个paragraph vector，相当于每次在预测单词的概率时，都利用了整个句子的语义。
2)	在预测阶段，给待预测的句子新分配一个paragraph id，词向量和输出层softmax的参数保持训练阶段得到的参数不变，重新利用梯度下降训练待预测的句子。待收敛后，即得到待预测句子的paragraph vector。

算法实现
-------------
利用Python的gensim.Doc2Vec接口进行模型训练，API如下：
<p>model = Doc2Vec(documents, size=100, window=8, min_count=5, workers=4)</p>
<p>documents为之前被处理好的TaggedDocument类型</p>	
<p>size是特征向量的维数</p>
<p>window是在文档中用于预测的预测单词和上下文单词之间的最大距离。</p>
<p>min_count是指低于此数量是词忽略不计</p>
<p>workers指线程数量</p>
<p>原始语料进行处理之后对模型进行训练，得到模型并进行存储。下一次使用直接调用节省时间</p>
'corpus_seg.txt'为分词好的语料，需要自行准备。

结果分析
-------------

输入句子：
收到实物与图片一模一样，实在很惊喜，包装的也很好，下次再来光顾哦！
```
输出句子：
0.6643092036247253 613
宝贝收到了，帮同事买的，很漂亮，同事很喜欢，下次还会再买，如果背后有收腰的话穿起来会更加好看，会显得更加瘦身，快递很给力，很快就收到了
0.658860981464386 124
衣服收到了，质量挺好的，包装也很好，和图片一样的款式，没有误差，下次还来买这家店
0.6414657831192017 1636
刚收到衣服，和图片上一样，还送了小礼物，很满意下次还来，上图给大家看看，有需要的可以参考一下！
0.5971564650535583 431
衣服收到了，质量挺好的，包装也很好，和图片一样的款式，没有误差，下次还来买这家店
0.5794812440872192 1237
宝贝收到不错喜欢，下次在来。合作愉快。
0.5783237218856812 2125
衣衣质量挺不错的，面料是纯棉的，还没穿，之后再来追加。谢谢热情的客服，好评。
0.5686043500900269 2061
刚刚收到，打开里面还有商家送的小礼物，衣服跟图片上的一模一样，面料也挺舒服，下次还会再卖
0.5669563412666321 989
挺好的，很满意，洗洗看看再说，好的话可以再光顾
0.5651070475578308 977
衣服收到了，很喜欢，店家服务态度很好，下次还会再来，好评！
```